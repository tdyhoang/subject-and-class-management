@model SubjectAndClassManagement.Models.Student
@{
    ViewData["Title"] = "Student Results";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<fieldset class="mb-4">
    <legend>Grade of student</legend>
    <div class="fieldset-wrapper">
        <form asp-controller="StudentResults" asp-action="Index" method="post">
            <div class="form-grade me-3 mb-2 float-start">
                <label class="mb-2">Academic Year</label>
                <select class="form-select" name="academicYear">
                    <option>2021-2022</option>
                    <option>2022-2023</option>
                    <option>2023-2024</option>
                    <option>2024-2025</option>
                </select>
            </div>

            <div class="form-grade me-3 mb-2 float-start">
                <label class="mb-2">Semester</label>
                <select class="form-select" name="semester">
                    <option>1</option>
                    <option>2</option>
                </select>
            </div>

            <div class="find-grade">
                <input type="submit" value="Search" class="form-find">
            </div>
        </form>
    </div>

    <div class="mt-3">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Subject ID</th>
                    <th>Subject name</th>
                    <th>Credits</th>
                    <th>Attendance</th>
                    <th>Middle</th>
                    <th>Final</th>
                    <th>Average</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Registrations != null)
                {   
                    foreach (var result in Model.Registrations)
                {
                    <tr>
                        <td>@result.Class.subject_id</td>
                        <td>@result.Class.Subject.subject_name</td>
                        <td>@result.Class.Subject.credit</td>
                        <td>@result.StudentResult.ResultColumns.FirstOrDefault(rc => rc.column_name == "Attendance")?.grade</td>
                        <td>@result.StudentResult.ResultColumns.FirstOrDefault(rc => rc.column_name == "Middle")?.grade</td>
                        <td>@result.StudentResult.ResultColumns.FirstOrDefault(rc => rc.column_name == "Final")?.grade</td>
                        <td>@result.StudentResult.grade</td>
                    </tr>
                }}
            </tbody>
        </table>
    </div>
</fieldset>
